define(["require","exports"],function(require,exports){"use strict";function product($scope,$rootScope,$location,ToolService,AjaxService){$scope.queryParams={city:"深圳",area:"",professionId:"",itemId:"",order:"",currentPage:1,pageRows:10,location:""},$scope.hasLocation=!1,$scope.orderParams=ToolService.orderParams,$scope.areaParams=ToolService.areaParams,$scope.classParams={},$scope.menuParams=[{has:!1,val:"区域",children:$scope.areaParams},{has:!1,val:"排序",children:$scope.orderParams},{has:!1,val:"分类",children:{}}],$scope.productParams={yake:{has:!1,val:"牙科",id:2},meirong:{has:!1,val:"医学美容",id:3},fck:{has:!1,val:"高端妇产科",id:4},zhongyi:{has:!1,val:"中医理疗",id:6}},$scope.title="",$scope.products=[];var initLocation=function(){ToolService.getSession("locationInfo")&&($scope.hasLocation=!0)},loadClassParams=function(){if($location.search().product){var product=$location.search().product;switch($scope.productParams[product].has=!0,$scope.title=$scope.productParams[product].val,$scope.queryParams.professionId=$scope.productParams[product].id,product){case"yake":$scope.classParams=ToolService.yakeParams;break;case"meirong":$scope.classParams=ToolService.meirongParams;break;case"fck":$scope.classParams=ToolService.fckParams;break;case"zhongyi":$scope.classParams=ToolService.zhongyiParams;break;default:$scope.classParams={}}}else ToolService.changeRoute("/home")};$scope.switchMenu=function(index,obj){ToolService.select(index,obj,!0),$rootScope.globalProp.hasBlackBg=obj[index].has},$scope.switchDrop=function(index,obj){ToolService.select(index,obj),obj===$scope.areaParams&&($scope.queryParams.area=obj[index].id,$scope.menuParams[0].has=!1),obj===$scope.orderParams&&($scope.queryParams.order=obj[index].id,$scope.menuParams[1].has=!1),obj===$scope.classParams&&($scope.queryParams.itemId=obj[index].id,$scope.menuParams[2].has=!1),$scope.products=[],$scope.queryParams.currentPage=1,$rootScope.followTip.has=!1,$rootScope.globalProp.hasBlackBg=!1,loadData()};var loadData=function(){AjaxService.post({url:ToolService.host+"/wx/product/querylist",data:$scope.queryParams}).then(function(data){data.length<1?($scope.products.length<1?$rootScope.followTip.val=$rootScope.followTip.empty:$rootScope.followTip.val=$rootScope.followTip.no,$rootScope.followTip.has=!0):(mergeProdcut(data),$scope.products=$scope.products.concat(data))})},mergeProdcut=function(items){items.forEach(function(item){null!=item.priceunit&&""!=item.priceunit?item.preferPriceType=item.pricetype+"/"+item.priceunit:item.preferPriceType=item.pricetype})};$scope.detail=function(productId,hospitalId){ToolService.changeRoute("/product/detail","flag=1&productId="+productId+"&hospitalId="+hospitalId)},$scope.question=function(){ToolService.alert("如有疑问，请致电0755-26905699")},ToolService.reset(),loadClassParams(),initLocation(),loadData(),ToolService.onWindowListen(function(){$scope.queryParams.currentPage++,loadData()})}return product});