define(function(){return function($scope,$rootScope,$location,Tool,Ajax){$scope.queryParams={city:"深圳",area:"",professionId:"",itemId:"",order:"",currentPage:1,pageRows:10,location:""},$scope.noProduct=!1,$scope.noProductText="",$scope.hasBg=!1,$scope.hasLocation=!1,$scope.hasOrder=!1,$scope.hasArea=!1,$scope.hasClass=!1,$scope.menuParams={area:!1,order:!1,classes:!1},$scope.orderParams={"default":{has:!0,val:""},price:{has:!1,val:"prefer_price asc"},priceDesc:{has:!1,val:"prefer_price desc"},scoreDesc:{has:!1,val:"hospital_score asc"},countDesc:{has:!1,val:"sales desc"},locationes:{has:!1,val:"locationes"}},$scope.areaParams={"default":{has:!0,val:""},futian:{has:!1,val:"福田区"},nanshan:{has:!1,val:"南山区"},luohu:{has:!1,val:"罗湖区"},baoan:{has:!1,val:"宝安区"},longhua:{has:!1,val:"龙华新区"},longgang:{has:!1,val:"龙岗区"},yantian:{has:!1,val:"盐田"}},$scope.classParams={},$scope.productParams={yake:{has:!1,val:"牙科",id:2},meirong:{has:!1,val:"医学美容",id:3},fck:{has:!1,val:"高端妇产科",id:4},zhongyi:{has:!1,val:"中医理疗",id:6}},$scope.title="",$scope.products=[],$scope.init=function(){$rootScope.hasBgColor=!1,$scope.loadClassParams(),$scope.initLocation(),$scope.loadData()},$scope.initLocation=function(){Tool.getSession("locationInfo")&&($scope.hasLocation=!0)},$scope.loadClassParams=function(){if($location.search().product){var product=$location.search().product;switch($scope.productParams[product].has=!0,$scope.title=$scope.productParams[product].val,$scope.queryParams.professionId=$scope.productParams[product].id,product){case"yake":$scope.classParams={all:{has:!0,id:""},zzy:{has:!1,id:19},xiya:{has:!1,id:20},kcy:{has:!1,id:82},buya:{has:!1,id:22},baya:{has:!1,id:23},ycmr:{has:!1,id:24},jiaozheng:{has:!1,id:64},yichi:{has:!1,id:65},yzzl:{has:!1,id:63},qita:{has:!1,id:60}};break;case"meirong":$scope.classParams={all:{has:!0,id:""},yanbu:{has:!1,id:7},mianbu:{has:!1,id:8},bibu:{has:!1,id:9},xiong:{has:!1,id:45},xizhi:{has:!1,id:12},simi:{has:!1,id:78},zhushe:{has:!1,id:79},jiguang:{has:!1,id:80},koucun:{has:!1,id:81},qita:{has:!1,id:13}};break;case"fck":$scope.classParams={all:{has:!0,id:""},jiancha:{has:!1,id:48},fenmian:{has:!1,id:49}};break;case"zhongyi":$scope.classParams={all:{has:!0,id:""},toubu:{has:!1,id:51},jianjing:{has:!1,id:52},yaobu:{has:!1,id:53},tuibu:{has:!1,id:54},quanshen:{has:!1,id:55},jingluo:{has:!1,id:56},qita:{has:!1,id:57}};break;default:$scope.classParams={all:{has:!0,id:""},zzy:{has:!1,id:19},xiya:{has:!1,id:20},kcy:{has:!1,id:82},buya:{has:!1,id:22},baya:{has:!1,id:23},ycmr:{has:!1,id:24},jiaozheng:{has:!1,id:64},yichi:{has:!1,id:65},yzzl:{has:!1,id:63},other:{has:!1,id:60}}}}else $scope.hasProduct.yake=!0,$scope.title=$scope.productParams.yake.val,$scope.queryParams.professionId=2},window.onscroll=function(){if(!$scope.loading&&!$scope.noProduct){var body=document.body,html=document.documentElement,height=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight);height>window.innerHeight&&height-window.scrollY-window.innerHeight<100&&$scope.loadNext()}},$scope.switchMenu=function(menu){switch(menu){case"area":$scope.hasOrder&&($scope.hasOrder=!1,$scope.menuParams.order=!1),$scope.hasClass&&($scope.hasClass=!1,$scope.menuParams.classes=!1),$scope.hasArea=!$scope.hasArea,$scope.hasArea?$scope.menuParams.area=!0:$scope.menuParams.area=!1;break;case"order":$scope.hasArea&&($scope.hasArea=!1,$scope.menuParams.area=!1),$scope.hasClass&&($scope.hasClass=!1,$scope.menuParams.classes=!1),$scope.hasOrder=!$scope.hasOrder,$scope.hasOrder?$scope.menuParams.order=!0:$scope.menuParams.order=!1;break;case"class":$scope.hasOrder&&($scope.hasOrder=!1,$scope.menuParams.order=!1),$scope.hasArea&&($scope.hasArea=!1,$scope.menuParams.area=!1),$scope.hasClass=!$scope.hasClass,$scope.hasClass?$scope.menuParams.classes=!0:$scope.menuParams.classes=!1}$scope.hasOrder||$scope.hasArea||$scope.hasClass?$scope.hasBg=!0:$scope.hasBg=!1},$scope.areaSelect=function(params){Tool.select(params,$scope.areaParams),$scope.queryParams.area=$scope.areaParams[params].val,$scope.queryParams.currentPage=1,$scope.products=[],$scope.noProduct=!1,$scope.loadData(),$scope.switchMenu("area")},$scope.orderSelect=function(params){if(Tool.select(params,$scope.orderParams),$scope.queryParams.order=$scope.orderParams[params].val,$scope.queryParams.currentPage=1,$scope.products=[],$scope.noProduct=!1,$scope.switchMenu("order"),"locationes"==params){var locationInfo=Tool.getSession("locationInfo");$scope.queryParams.location=locationInfo.longitude+","+locationInfo.latitude}else $scope.queryParams.location="";$scope.loadData()},$scope.classSelect=function(params){Tool.select(params,$scope.classParams),$scope.queryParams.itemId=$scope.classParams[params].id,$scope.queryParams.currentPage=1,$scope.products=[],$scope.noProduct=!1,$scope.switchMenu("class"),$scope.loadData()},$scope.loadData=function(){Ajax.post({url:Tool.host+"/wx/product/querylist",params:$scope.queryParams}).then(function(data){data.length<1?($scope.products.length<1?$scope.noProductText="没有项目信息,请选择其他区域或者时间!":$scope.noProductText="已经没有项目了!",$scope.noProduct=!0):($scope.mergeProdcut(data),$scope.products=$scope.products.concat(data))})["catch"](function(){$scope.noProduct=!0,Tool.alert("数据加载失败，请稍后再试!")})["finally"](function(){$rootScope.loading=!1})},$scope.mergeProdcut=function(items){items.forEach(function(item){null!=item.priceunit&&""!=item.priceunit?item.preferPriceType=item.pricetype+"/"+item.priceunit:item.preferPriceType=item.pricetype})},$scope.loadNext=function(){$scope.queryParams.currentPage++,$scope.loadData()},$scope.detail=function(productId,hospitalId){Tool.changeRoute("/product/detail","flag=1&productId="+productId+"&hospitalId="+hospitalId)},$scope.question=function(){Tool.alert("如有疑问，请致电0755-26905699")}}});