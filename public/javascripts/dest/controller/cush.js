define(["require","exports"],function(require,exports){"use strict";function cush($scope,$rootScope,ToolService,AjaxService){$scope.cushs=null,$scope.noCush=!1,$scope.activeValue="";var loadCush=function(){AjaxService.post({url:ToolService.host+"/wx/order/findAllVouchers",data:{userId:ToolService.user.id},headers:{accessToken:ToolService.user.accessToken}}).then(function(data){0==data.code?0==data.data.length?$scope.noCush=!0:(merge(data.data),$scope.cushs=data.data):ToolService.alert("数据加载失败，请稍后再试!")})},merge=function(items){items.forEach(function(item){item.flags>item.money?item.used=!0:item.uesd=!1})};$scope.active=function(){6==$scope.activeValue.length?AjaxService.post({url:ToolService.host+"/wx/order/activate",data:{userId:ToolService.user.id,code:$scope.activeValue},headers:{accessToken:ToolService.user.accessToken}}).then(function(data){0==data.code?(merge(data.data),$scope.cushs=data.data):ToolService.alert("代金券不正确!")}):ToolService.alert("请输入正确长度的代金券!")},ToolService.reset(),$rootScope.globalProp.hasBgColor=!0,ToolService.checkLogin()?(ToolService.loadUser(),loadCush()):ToolService.changeRoute("/user")}return cush});