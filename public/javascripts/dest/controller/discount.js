define(["require","exports"],function(require,exports){"use strict";function discount($scope,$rootScope,ToolService,AjaxService){$scope.itemState="discount",$scope.discountSelect=!0,$scope.currentPage=1,$scope.productInfo=[];var loadGift=function(){if("discount"==$scope.itemState)var url=ToolService.host+"/wx/order/queryByGift";else var url=ToolService.host+"/wx/order/queryGift";AjaxService.post({url:url,data:{currentPage:$scope.currentPage},headers:{accessToken:""}}).then(function(data){0==data.code?data.data.length<1?($scope.productInfo.length<1?$rootScope.followTip.val=$rootScope.followTip.empty:$rootScope.followTip.val=$rootScope.followTip.no,$rootScope.followTip.has=!0):(mergeProdcut(data.data),$scope.productInfo=$scope.productInfo.concat(data.data)):ToolService.alert(data.message)})},mergeProdcut=function(items){items.forEach(function(item){null!=item.priceunit&&""!=item.priceunit?item.preferPriceType=item.pricetype+"/"+item.priceunit:item.preferPriceType=item.pricetype,item.money&&(item.preferPrice=item.money)})};$scope.switchState=function(item){$scope.itemState!=item&&("discount"==item?$scope.discountSelect=!0:$scope.discountSelect=!1),$scope.currentPage=1,$rootScope.followTip.has=!1,$scope.itemState=item,$scope.productInfo=[],loadGift()},$scope.detail=function(proId,hospitalId,preferPrice){var query="productId="+proId+"&hospitalId="+hospitalId;"discount"==$scope.itemState?query+="&code=123":"month"==$scope.itemState&&(query+="&discountid=123&flag=11&money="+preferPrice),ToolService.changeRoute("/product/detail",query)},$scope.question=function(){ToolService.alert("如有疑问，请致电0755-26905699")},ToolService.reset(),loadGift(),ToolService.onWindowListen(function(){$scope.currentPage++,loadGift()})}return discount});