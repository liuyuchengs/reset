define(function(){return function($scope,$rootScope,Tool,Ajax){$scope.userId,$scope.accessToken,$scope.cushs,$scope.noCushOver=!1,$scope.init=function(){$rootScope.hasBgColor=!0,Tool.noWindowListen(),Tool.checkLogin()?(Tool.loadUserinfo(),$scope.loadCushOver()):Tool.changeRoute("/user")},$scope.loadCushOver=function(){Ajax.post({url:Tool.host+"/wx/order/overdue",params:{userId:Tool.userInfo.id},headers:{accessToken:Tool.userInfo.accessToken}}).then(function(data){0==data.code?data.data.length<1?$scope.noCushOver=!0:($scope.merge(data.data),$scope.cushs=data.data):Tool.alert("数据加载失败，请稍后再试!")})["catch"](function(){Tool.alert("数据加载失败，请稍后再试!")})["finally"](function(){$rootScope.loading=!1})},$scope.merge=function(items){items.forEach(function(item,index,array){1==item.state?item.mess="已使用":3==item.state&&(item.mess="已过期")})}}});