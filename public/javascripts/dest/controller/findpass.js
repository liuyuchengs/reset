define(["require","exports"],function(require,exports){"use strict";function findpass($scope,$rootScope,$location,$interval,ToolService,AjaxService){$scope.phone="",$scope.code="",$scope.pwd="",$scope.getPhone=$location.search().phone||"",$scope.getCodes=$location.search().code||"",$scope.hasSendCode=!1,$scope.codeText="获取短信验证码",$scope.sendCodes=!1,$scope.checkPhone=function(){/^1[3|4|5|7|8]\d{9}$/.test($scope.phone)?AjaxService.post({url:ToolService.host+"/wx/findpass/findPassPhontCheck",data:{name:"phone",param:$scope.phone}}).then(function(data){0==data.code?ToolService.changeRoute("/findpwd/code","phone="+$scope.phone):ToolService.alert(data.message)}):ToolService.alert("请输入正确的手机号码!")},$scope.checkCode=function(){$scope.sendCodes?4==$scope.code.length?AjaxService.post({url:ToolService.host+"/wx/findpass/findPassPhontCheck",data:{name:"verifyCode",param:$scope.code,p:$scope.getPhone}}).then(function(data){0==data.code?ToolService.changeRoute("/findpwd/pwd","phone="+$scope.getPhone+"&code="+$scope.code):ToolService.alert(data.message)}):ToolService.alert("请输入4位验证码"):ToolService.alert("请先获取验证码")},$scope.changePwd=function(){$scope.pwd.length>=8&&$scope.pwd.length<=20&&AjaxService.post({url:ToolService.host+"/wx/findpass/changepwd",data:{phone:$scope.getPhone,code:$scope.getCodes,password:$scope.pwd}}).then(function(data){0==data.code?ToolService.alert("密码修改成功!",function(){$rootScope.followTip.has=!1,ToolService.changeRoute("/login")}):ToolService.alert(data.message)})},$scope.getCode=function(){$scope.hasSendCode||AjaxService.post({url:ToolService.host+"/wx/findpass/sendsmsfindpasscode",data:{phone:$scope.getPhone}}).then(function(data){if(0==data.code){$scope.hasSendCode=!0,$scope.sendCodes=!0;var time=59,interval=$interval(function(){$scope.codeText=time+" S",time--},1e3,60).then(function(){$scope.codeText="获取短信验证码",$scope.hasSendCode=!1,$interval.cancel(interval)})}else ToolService.alert(data.mesage)})},ToolService.reset(),$rootScope.globalProp.hasBgColor=!0}return findpass});