define(function(){return function($scope,$rootScope,$http,Tool,Ajax){$scope.noProductText="",$scope.noProduct=!1,$scope.hasInteractionMenu=!0,$scope.queryParams={flag:1,pageRows:10,currentPage:1},$scope.navParams={kanya:{has:!0,val:1},shumei:{has:!1,val:2},yunsheng:{has:!1,val:3}},$scope.posts=[],$scope.init=function(){$rootScope.hasBgColor=!1,$scope.queryPost(),$scope.initSwiper()},$scope.queryPost=function(){Ajax.post({url:Tool.host+"/wx/post/postList",params:$scope.queryParams}).then(function(data){data.data.length<1?($scope.posts.length<1?$scope.noProductText="还没有帖子信息":$scope.noProductText="已经没有项目了!",$scope.noProduct=!0):($scope.mergePost(data.data),$scope.posts=$scope.posts.concat(data.data))})["catch"](function(){Tool.alert("获取帖子信息失败!")})["finally"](function(){$rootScope.loading=!1})},$scope.mergePost=function(items){items.forEach(function(item){null!=item.visitNum&&""!=item.visitNum||(item.visitNum=0),""!=item.commentNum&&null!=item.commentNum||(item.commentNum=0),item.faceImage="https://biz.uokang.com/"+item.faceImage;for(var index in item.list2)""!=item.list2[index]&&null!=item.list2[index]||item.list2.splice(index,1)})},$scope.loadNext=function(){$scope.queryParams.currentPage++,$scope.queryPost()},window.onscroll=function(){if(!$rootScope.loading&&!$scope.noProduct){var body=document.body,html=document.documentElement,height=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight);height>window.innerHeight&&height-window.scrollY-window.innerHeight<100&&$scope.loadNext()}},$scope.switchNav=function(item){$scope.queryParams.flag=$scope.navParams[item].val,Tool.select(item,$scope.navParams),$scope.queryParams.currentPage=1,$scope.noProduct=!1,$scope.noProductText="",$scope.posts=[],$scope.queryPost()},$scope.detail=function(id){Tool.changeRoute("/interaction/detail","id="+id)}}});