define(["require","exports"],function(require,exports){"use strict";function activity($scope,$rootScope,$location,ToolService,AjaxService){$scope.products=[],$scope.detail=function(productId,hospitalId,type){productId&&hospitalId&&type&&(5===type&&ToolService.changeRoute("/exam/detail","productId="+productId+"&hospitalId="+hospitalId),6===type?ToolService.changeRoute("/exam/detail","productId="+productId+"&hospitalId="+hospitalId+"&activityp=元/次"):ToolService.changeRoute("/product/detail","productId="+productId+"&hospitalId="+hospitalId))};var queryParams={pageRows:10,currentPage:1,flag:""},queryActivity=function(){AjaxService.post({url:ToolService.host+"/wx/product/queryActivity",data:queryParams}).then(function(data){0===data.code&&(data.data.length<1?($scope.products.length<1?$rootScope.followTip.val=$rootScope.followTip.empty:$rootScope.followTip.val=$rootScope.followTip.no,$rootScope.followTip.has=!0):(mergeActivity(data.data),$scope.products=$scope.products.concat(data.data)))})["catch"](function(){ToolService.alert("获取数据失败")})["finally"](function(){$rootScope.load.has=!1})},mergeActivity=function(items){items.forEach(function(item){null!=item.priceunit&&""!=item.priceunit?item.preferPriceType=item.pricetype+"/"+item.priceunit:item.preferPriceType=item.pricetype,6===item.type&&(item.hasActivity=!0)})},loadNext=function(){queryParams.currentPage++,queryActivity()};$rootScope.globalProp.hasBgColor=!1,$rootScope.followTip.has=!1,$rootScope.followTip.val="",$location.search().flag?(queryParams.flag=$location.search().flag,queryActivity(),ToolService.onWindowListen(loadNext)):ToolService.changeRoute("/home")}return activity});