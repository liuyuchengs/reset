define(["require","exports"],function(require,exports){"use strict";function invite($scope,$rootScope,$location,ToolService,AjaxService,WeixinService){$scope.bgStyle={width:window.screen.width,height:window.screen.width/320*145},$scope.bodyStyle={width:window.screen.width,"min-height":window.screen.height-50},$scope.shareObj={title:"悠康医生邀请好友即送现金啦",desc:"悠康医生邀请好友即可获得现金和代金券，快来看看吧!",link:"https://www.uokang.com/v2/htmls/index.html#/invite/register",imgUrl:"https://www.uokang.com/new/contents/img/logo.png",success:function(){$scope.showTip=!1,ToolService.alert("分享成功!")},cancel:function(){},ready:!1},$scope.code="",$scope.showTip=!1;var inviteInit=function(){if($location.search().at){var accessToken=$location.search().at;queryCode(accessToken)}else ToolService.checkLogin()?(ToolService.loadUser(),queryCode(ToolService.user.accessToken),WeixinService.wxInit(),WeixinService.wxConfig()):ToolService.alert("请先登录",function(){$rootScope.messageTip.has=!1,ToolService.changeRoute("/user")})},queryCode=function(accessToken){AjaxService.post({url:ToolService.host+"/wx/user/createReferralCode",data:{accessToken:accessToken}}).then(function(data){0==data.code?($scope.code=data.data.referralCode,$scope.shareObj.link=$scope.shareObj.link+"?code="+$scope.code+"&name="+ToolService.user.nickname,$scope.shareObj.ready=!0):ToolService.alert("查询邀请码错误!")})};$scope.switchTip=function(item){"close"===item&&($scope.showTip=!1),"open"===item&&($scope.showTip=!0)},$scope.share=function(){$scope.shareObj.ready?($scope.switchTip("open"),WeixinService.wxShare($scope.shareObj)):ToolService.alert("获取分享内容失败，请稍后再试！")};var registerInit=function(){$location.search().code?($scope.code=$location.search().code,$scope.name=$location.search().name):ToolService.alert("请检查链接是否完整",function(){$rootScope.messageTip.has=!1,ToolService.changeRoute("/home")})};if($scope.goRegister=function(){ToolService.changeRoute("/register","code="+$scope.code)},ToolService.reset(),$location.path()){var path=$location.path();"/invite/new"===path?inviteInit():"/invite/register"===path&&registerInit()}else ToolService.changeRoute("/home")}return invite});