{"version":3,"sources":["routes/loginRoute.ts"],"names":[],"mappings":";;;;;;;;;AAAA,kDAAkD;AAClD,MAAO,OAAO,WAAW,SAAS,CAAC,CAAC;AACpC,MAAO,UAAU,WAAW,yBAAyB,CAAC,CAAC;AACvD,MAAO,SAAS,WAAW,2BAA2B,CAAC,CAAC;AAExD;;;GAGG;AACH,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC;AAE9B;;;;;;;;;;;;;;;;;;;;;;;;;;;GA2BG;AACH,iBAAuB,GAAO,EAAC,GAAO;;QAClC,EAAE,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,IAAI,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;YACtC,IAAI,MAAiB,CAAC;YACtB,EAAE,CAAA,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAA,CAAC;gBAC1B,IAAG,CAAC;oBACA,MAAM,GAAI,MAAM,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;gBAC9C,CAAC;gBAAA,KAAK,CAAA,CAAC,GAAG,CAAC,CAAA,CAAC;oBACR,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;oBACjB,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC;gBAC1B,CAAC;YAEL,CAAC;YAAA,IAAI,CAAA,CAAC;gBACF,MAAM,GAAG,UAAU,CAAC,gBAAgB,CAAC,eAAe,CAAC,CAAC;YAC1D,CAAC;YACD,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACrB,CAAC;QACD,IAAI,CAAC,CAAC;YACF,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QACvC,CAAC;IACL,CAAC;CAAA;AACD,MAAM,CAAC,IAAI,CAAC,UAAU,EAAC,OAAO,CAAC,CAAC;AAEhC,iBAAS,MAAM,CAAC","file":"routes/loginRoute.js","sourcesContent":["/// <reference path=\"./../../typings/index.d.ts\"/>\nimport express = require('express');\nimport HttpResult = require(\"./../modules/HttpResult\");\nimport LoginCtrl = require(\"./../controller/LoginCtrl\");\n\n/**\n * 登录相关接口\n * @module\n */\nlet router = express.Router();\n\n/**\n * /wx/login/wxlogin - 用户登录\n * @param {string} phone - 手机号码\n * @param {string} password - 密码\n * @return {HttpResult|Error} 登录结果\n * @example\n * // 请求参数\n * phone=18124792560&password=uokang123\n * // 响应结果\n * {\n *   \"data\":\n *     {\n *       \"id\":11326,\n *       \"nickname\":\"小绿皮\",\n *       \"phone\":\"18124792560\",\n *       \"face\":\"upload/image/post/20160701/3df467e43f2d4a11aeba237b715e5a54.jpeg\",\n *       \"sex\":\"男\",\n *       \"realname\":\"123\",\n *       \"email\":null,\n *       \"gift_code\":1,\n *       \"alipay\":\"liuyuchengs\",\n *       \"wxpay\":\"399865\",\n *       \"referralCode\":17802,\n *       \"accessToken\":\"c0925312c3d549d3a51d83ab1c58f157\"\n *     },\n *   \"code\":0,\n *   \"message\":\"登录成功!\"}\n */\nasync function wxlogin(req:any,res:any){\n    if (req.body.phone && req.body.password) {\n        let result:HttpResult;\n        if(LoginCtrl.check(req.body)){\n            try{\n                result =  await LoginCtrl.login(req.body);\n            }catch(err){\n                console.log(err);\n                res.status(500).end();\n            }\n            \n        }else{\n            result = HttpResult.CreateFailResult(\"请输入正确的账号或者密码!\");\n        }\n        res.send(result);\n    }\n    else {\n        res.status(400).send(\"bad params\");\n    }\n}\nrouter.post(\"/wxlogin\",wxlogin);\n\nexport = router;"],"sourceRoot":"../src"}